{% extends "cfp/event/base.html" %}
{% load i18n %}
{% load bootstrap4 %}
{% load staticfiles %}
{% block title %}{% trans "Your Profile" %} :: {{ request.event }}{% endblock %}
{% block content %}
    <h2>{% trans "Your Profile" %}</h2>
    <p>
        {% trans "This data will be displayed next to your talk slots in the schedule." %}
    </p>
    <form action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {% bootstrap_field profile_form.get_gravatar %}
        <div class="user-avatar-display">
            <div class="col-md-3 control-label">
            {% if request.user.avatar and request.user.avatar != 'False' %}
                <img src="{{ request.user.avatar.url }}">
            {% endif %}
            </div>
            {% bootstrap_field profile_form.avatar layout='inline' %}
        </div>
        {% bootstrap_field profile_form.name layout='horizontal' %}
        {% bootstrap_field profile_form.biography layout='horizontal' %}
        {% bootstrap_field profile_form.availabilities layout='horizontal' %}
        <div class="row">
            <div class="col-md-3 ml-auto">
                <button type="submit" class="btn btn-block btn-success btn-lg" name="form" value="profile">
                    {% trans "Save" %}
                </button>
            </div>
        </div>
    </form>

    {% if questions_exist %}
    <h2>{% trans "We have some questions" %}</h2>
    <form action="" method="post">
        {% csrf_token %}
        {% bootstrap_form questions_form layout='horizontal' %}
        <div class="row">
            <div class="col-md-3 ml-auto">
                <button type="submit" class="btn btn-block btn-success btn-lg" name="form" value="questions">
                    {% trans "Save" %}
                </button>
            </div>
        </div>
    </form>
    {% endif %}

    <h2>{% trans "Your Account" %}</h2>
    <p>
        {% trans "You can change your log in data here." %}
    </p>
    <form action="" method="post" class="form">
        {% csrf_token %}
        {% bootstrap_field login_form.old_password layout='horizontal' %}
        {% bootstrap_field login_form.email layout='horizontal' %}
        {% bootstrap_field login_form.password layout='horizontal' %}
        {% bootstrap_field login_form.password_repeat layout='horizontal' %}
        <div class="row">
            <div class="col-md-3 ml-auto">
                <button type="submit" class="btn btn-block btn-success btn-lg" name="form" value="login">
                    {% trans "Save" %}
                </button>
            </div>
        </div>
    </form>
    <div>&nbsp;</div>
    <h3>{% trans "Account deletion" %}</h3>
    <form action="{{ request.event.urls.user_delete }}" method="post" class="form">
        {% csrf_token %}
        <div class="alert alert-danger">
            {% trans "You can delete your account here â€“ all names, emails etc will be overwritten. <strong>This action is irreversible.</strong>" %}
        </div>
        <div class="form-group"{% if not "really" in request.GET %} style="visibility:hidden;"{% endif %}>
                <input type="checkbox" name="really" id="really">
                <label class="form-control-label" for="really">{% trans "I really do want to delete my account, losing access to my submissions and talks, and overriding my public and private data." %}</label>
            </div>
            <div class="col-md-3 ml-auto">
                <button type="submit" class="btn btn-block btn-danger btn-lg" name="form" value="">
                    {% trans "Delete my account" %}
                </button>
            </div>
    </form>
    <script type="text/javascript" src="{% static "cfp/js/profile.js" %}"></script>
{% endblock %}



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing an e-mail placeholder plugin &mdash; pretix 3.18.0.dev0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/pretix.css" type="text/css" />

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/pretix.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" type="text/css" />
  

  
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="pretix 3.18.0.dev0 documentation" href="../../index.html"/>
        <link rel="up" title="Plugin development" href="index.html"/>
        <link rel="next" title="Writing an invoice renderer plugin" href="invoice.html"/>
        <link rel="prev" title="Writing an HTML e-mail renderer plugin" href="email.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo-white.svg" class="logo" />
          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin/index.html">Administrator documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">REST API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../concepts.html">Concepts and Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup.html">Development setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution/index.html">Contributing to pretix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../implementation/index.html">Implementation and Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../translation/index.html">Translating pretix</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Plugin development</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plugins.html">Creating a plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="exporter.html">Writing an exporter plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="ticketoutput.html">Writing a ticket output plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="payment.html">Writing a payment provider plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="payment_2.0.html">Porting a payment provider from pretix 1.x to pretix 2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="email.html">Writing an HTML e-mail renderer plugin</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing an e-mail placeholder plugin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#placeholder-registration">Placeholder registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#context-mechanism">Context mechanism</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-placeholder-class">The placeholder class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#helper-class-for-simple-placeholders">Helper class for simple placeholders</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="invoice.html">Writing an invoice renderer plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="shredder.html">Writing a data shredder</a></li>
<li class="toctree-l3"><a class="reference internal" href="import.html">Extending the order import process</a></li>
<li class="toctree-l3"><a class="reference internal" href="customview.html">Creating custom views</a></li>
<li class="toctree-l3"><a class="reference internal" href="auth.html">Pluggable authentication backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="general.html">General APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="quality.html">Plugin quality checklist</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../structure.html">Directory structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Plugin documentation</a></li>
</ul>

            
          
        </div>

          
              
              
                  <div class="version">
                      3.18
                  </div>
              
          
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pretix</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer documentation</a> &raquo;</li>
        
          <li><a href="index.html">Plugin development</a> &raquo;</li>
        
      <li>Writing an e-mail placeholder plugin</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/api/placeholder.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="writing-an-e-mail-placeholder-plugin">
<h1>Writing an e-mail placeholder plugin<a class="headerlink" href="#writing-an-e-mail-placeholder-plugin" title="Permalink to this heading">¶</a></h1>
<p>An email placeholder is a dynamic value that pretix users can use in their email templates.</p>
<p>Please read <a class="reference internal" href="plugins.html#pluginsetup"><span class="std std-ref">Creating a plugin</span></a> first, if you haven’t already.</p>
<section id="placeholder-registration">
<h2>Placeholder registration<a class="headerlink" href="#placeholder-registration" title="Permalink to this heading">¶</a></h2>
<p>The placeholder API does not make a lot of usage from signals, however, it
does use a signal to get a list of all available email placeholders. Your plugin
should listen for this signal and return an instance of a subclass of <code class="docutils literal notranslate"><span class="pre">pretix.base.email.BaseMailTextPlaceholder</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span><span class="w"> </span><span class="nn">django.dispatch</span><span class="w"> </span><span class="kn">import</span> <span class="n">receiver</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="kn">from</span><span class="w"> </span><span class="nn">pretix.base.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_mail_placeholders</span>
<span class="linenos">4</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="nd">@receiver</span><span class="p">(</span><span class="n">register_mail_placeholders</span><span class="p">,</span> <span class="n">dispatch_uid</span><span class="o">=</span><span class="s2">&quot;placeholder_custom&quot;</span><span class="p">)</span>
<span class="linenos">7</span><span class="k">def</span><span class="w"> </span><span class="nf">register_mail_renderers</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">8</span>    <span class="kn">from</span><span class="w"> </span><span class="nn">.email</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyPlaceholderClass</span>
<span class="linenos">9</span>    <span class="k">return</span> <span class="n">MyPlaceholder</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="context-mechanism">
<h2>Context mechanism<a class="headerlink" href="#context-mechanism" title="Permalink to this heading">¶</a></h2>
<p>Emails are sent in different “contexts” within pretix. For example, many emails are sent in the
the context of an order, but some are not, such as the notification of a waiting list voucher.</p>
<p>Not all placeholders make sense in every email, and placeholders usually depend some parameters
themselves, such as the <code class="docutils literal notranslate"><span class="pre">Order</span></code> object. Therefore, placeholders are expected to explicitly declare
what values they depend on and they will only be available in an email if all those dependencies are
met. Currently, placeholders can depend on the following context parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">event</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">waiting_list_entry</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">invoice_address</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">payment</span></code></p></li>
</ul>
<p>There are a few more that are only to be used internally but not by plugins.</p>
</section>
<section id="the-placeholder-class">
<h2>The placeholder class<a class="headerlink" href="#the-placeholder-class" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pretix.base.email.BaseMailTextPlaceholder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pretix.base.email.</span></span><span class="sig-name descname"><span class="pre">BaseMailTextPlaceholder</span></span><a class="headerlink" href="#pretix.base.email.BaseMailTextPlaceholder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.identifier">
<span class="sig-prename descclassname"><span class="pre">BaseMailTextPlaceholder.</span></span><span class="sig-name descname"><span class="pre">identifier</span></span><a class="headerlink" href="#pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>This should return the identifier of this placeholder in the email.</p>
<p>This is an abstract attribute, you <strong>must</strong> override this!</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.required_context">
<span class="sig-prename descclassname"><span class="pre">BaseMailTextPlaceholder.</span></span><span class="sig-name descname"><span class="pre">required_context</span></span><a class="headerlink" href="#pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.required_context" title="Permalink to this definition">¶</a></dt>
<dd><p>This property should return a list of all attribute names that need to be
contained in the base context so that this placeholder is available. By default,
it returns a list containing the string “event”.</p>
<p>This is an abstract attribute, you <strong>must</strong> override this!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.render">
<span class="sig-prename descclassname"><span class="pre">BaseMailTextPlaceholder.</span></span><span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.render" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called to generate the actual text that is being
used in the email. You will be passed a context dictionary with the
base context attributes specified in <code class="docutils literal notranslate"><span class="pre">required_context</span></code>. You are
expected to return a plain-text string.</p>
<p>This is an abstract method, you <strong>must</strong> implement this!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.render_sample">
<span class="sig-prename descclassname"><span class="pre">BaseMailTextPlaceholder.</span></span><span class="sig-name descname"><span class="pre">render_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pretix.base.email.pretix.base.email.BaseMailTextPlaceholder.BaseMailTextPlaceholder.render_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called to generate a text to be used in email previews.
This may only depend on the event.</p>
<p>This is an abstract method, you <strong>must</strong> implement this!</p>
</dd></dl>

</dd></dl>

</section>
<section id="helper-class-for-simple-placeholders">
<h2>Helper class for simple placeholders<a class="headerlink" href="#helper-class-for-simple-placeholders" title="Permalink to this heading">¶</a></h2>
<p>pretix ships with a helper class that makes it easy to provide placeholders based on simple
functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">SimpleFunctionalMailTextPlaceholder</span><span class="p">(</span>
    <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">order</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="s1">&#39;F8VVL&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="invoice.html" class="btn btn-neutral float-right" title="Writing an invoice renderer plugin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="email.html" class="btn btn-neutral" title="Writing an HTML e-mail renderer plugin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2025, Raphael Michel.

    </p>
  </div>
    <small>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a theme that is based on a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.</small> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'3.18.0.dev0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
      <script type="text/javascript" src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>